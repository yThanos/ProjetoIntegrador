--DTABASE: AppFinanceiro

CREATE TABLE USUARIOS
(
    CODIGO SERIAL PRIMARY KEY,
    NOME VARCHAR(30),
    EMAIL VARCHAR(60),
    SENHA VARCHAR(20),
    CPF VARCHAR(15),
    PERMISSAO VARCHAR(5),
    ATIVO BOOLEAN
);

INSERT INTO USUARIOS (NOME, EMAIL, SENHA, CPF, PERMISSAO, ATIVO) VALUES
('Vitor Fraporti', 'vitorfraporti@hotmail.com', '12345', '034.626.290-93', 'USER', true);

INSERT INTO USUARIOS (NOME, EMAIL, SENHA, CPF, PERMISSAO, ATIVO) VALUES
('ADMIN', 'ADMIN', '654321', '123.456.789-09', 'ADMIN', true);

UPDATE USUARIOS SET CODIGO = 0 WHERE CODIGO = 2;

CREATE TABLE GRUPOS
(
    CODIGO SERIAL PRIMARY KEY,
    NOME VARCHAR(40),
    DESCRICAO VARCHAR(100),
    ATIVO BOOLEAN
);

INSERT INTO GRUPOS (NOME, DESCRICAO, ATIVO) 
	VALUES ('Grupo teste', 'Teste para ver se as relações estão corretas', true);

CREATE TABLE USUARIO_GRUPO
(
    CODIGO SERIAL PRIMARY KEY,
    CODIGO_GRUPO INTEGER,
    CODIGO_USUARIO INTEGER,
    FOREIGN KEY (CODIGO_GRUPO) REFERENCES GRUPOS (CODIGO),
    FOREIGN KEY (CODIGO_USUARIO) REFERENCES USUARIOS (CODIGO)
);
	
INSERT INTO USUARIO_GRUPO(CODIGO_GRUPO, CODIGO_USUARIO)
	VALUES (1, 1);

CREATE TABLE DESPESAS
(
    CODIGO SERIAL PRIMARY KEY,
    NOME VARCHAR(20),
    DESCRICAO VARCHAR(100),
    VALOR NUMERIC(5,2),
    ATIVO BOOLEAN
);

INSERT INTO DESPESAS (NOME, DESCRICAO, VALOR, ATIVO)
    VALUES ('Agua', 'Conta de agua do mes', 44.34, true);
INSERT INTO DESPESAS (NOME, DESCRICAO, VALOR, ATIVO)
    VALUES ('Luz', 'Conta de luz do mes', 84.59, true);
INSERT INTO DESPESAS (NOME, DESCRICAO, VALOR, ATIVO)
    VALUES ('Salgadinho', 'Doritos no peruzzo', 12.90, true);

CREATE TABLE USUARIO_DESPESA
(
    CODIGO SERIAL PRIMARY KEY,
    CODIGO_USUARIO INTEGER,
    CODIGO_DESPESA INTEGER,
    FOREIGN KEY (CODIGO_USUARIO) REFERENCES USUARIOS (CODIGO),
    FOREIGN KEY (CODIGO_DESPESA) REFERENCES DESPESAS (CODIGO)
);

INSERT INTO USUARIO_DESPESA (CODIGO_USUARIO, CODIGO_DESPESA)
    VALUES (1, 1);
INSERT INTO USUARIO_DESPESA (CODIGO_USUARIO, CODIGO_DESPESA)
    VALUES (1, 2);

CREATE TABLE GRUPO_DESPESA
(
    CODIGO SERIAL PRIMARY KEY,
    CODIGO_GRUPO INTEGER,
    CODIGO_DESPESA INTEGER,
    FOREIGN KEY (CODIGO_GRUPO) REFERENCES GRUPOS (CODIGO),
    FOREIGN KEY (CODIGO_DESPESA) REFERENCES DESPESAS (CODIGO)
);

INSERT INTO GRUPO_DESPESA (CODIGO_GRUPO, CODIGO_DESPESA)
    VALUES (1, 1);
INSERT INTO GRUPO_DESPESA (CODIGO_GRUPO, CODIGO_DESPESA)
    VALUES (1, 2);

CREATE TABLE USUARIO_GRUPO_DESPESA
(
    CODIGO SERIAL PRIMARY KEY,
    CODIGO_USUARIO INTEGER,
    CODIGO_GRUPO_DESPESA INTEGER,
    VALOR NUMERIC(5,2),
    FOREIGN KEY (CODIGO_USUARIO) REFERENCES USUARIOS (CODIGO),
    FOREIGN KEY (CODIGO_GRUPO_DESPESA) REFERENCES GRUPO_DESPESA (CODIGO)
);

INSERT INTO USUARIO_GRUPO_DESPESA (CODIGO_USUARIO, CODIGO_GRUPO_DESPESA, VALOR)
    VALUES (1, 1, 22.17);
INSERT INTO USUARIO_GRUPO_DESPESA (CODIGO_USUARIO, CODIGO_GRUPO_DESPESA, VALOR)
    VALUES (1, 2, 42.29);